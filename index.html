<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>é¸ä¸€å€‹å±¬æ–¼æˆ‘å€‘çš„ä»Šå¤©</title>
<meta name="description" content="ä¸€å€‹ç‚ºå¥¹è¨­è¨ˆçš„æµªæ¼«å°äº’å‹•ï¼Œå¾å…©å€‹å£è¢‹ç›®çš„åœ°é–‹å§‹ï¼Œé¸å‡ºæ­¤åˆ»æœ€æƒ³å»çš„åœ°æ–¹ã€‚" />
<style>
  :root{
    /* é€™è£¡ä¹‹å¾Œå¯æ›æˆä½ æŒ‡å®šé¢¨æ ¼è‰²ç³» */
    --bg:#f7f7fb;
    --card:#ffffff;
    --ink:#1f2937;
    --ink-2:#6b7280;
    --brand:#2563eb;     /* ä¸»è‰² */
    --accent:#f59e0b;    /* é»ç¶´è‰² */
    --shadow:0 12px 30px rgba(0,0,0,.08);
    --radius:22px;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;font-family:ui-rounded, system-ui, -apple-system, "Segoe UI",
    "PingFang TC","Noto Sans TC","Microsoft JhengHei",sans-serif;
    color:var(--ink); background:linear-gradient(180deg,#fff, var(--bg) 40%, #fff);
    -webkit-tap-highlight-color: transparent;
  }
  .wrap{min-height:100vh; display:flex; flex-direction:column; align-items:center; }
  header{
    width:100%; padding:14px 16px; display:flex; align-items:center; justify-content:center;
    position:sticky; top:0; z-index:10; backdrop-filter:saturate(180%) blur(8px);
  }
  .title{font-weight:800; letter-spacing:.5px}
  .gear{
    position:absolute; right:10px; top:10px; border:none; background:transparent; font-size:20px; cursor:pointer;
  }

  main{width:100%; flex:1; display:flex; align-items:center; justify-content:center; padding:18px 16px 28px;}
  .card{
    width:100%; max-width:540px; background:var(--card); border-radius:var(--radius); box-shadow:var(--shadow);
    padding:18px; position:relative; overflow:hidden;
  }
  .pill{display:inline-block; font-size:12px; padding:6px 10px; border-radius:999px; background:#eef2ff; color:#3730a3; margin-bottom:6px}
  .lead{font-size:20px; line-height:1.5; font-weight:700;}
  .sub{color:var(--ink-2); margin-top:6px}

  .stage{margin-top:16px; position:relative;}
  .option{
    background:#fff; border:1px solid #eef2f7; border-radius:18px; padding:14px;
    display:flex; gap:12px; align-items:center; margin:12px 0; cursor:pointer;
    transition:transform .15s ease, box-shadow .15s ease, border-color .15s ease;
  }
  .option:hover{transform:translateY(-1px); box-shadow:0 6px 20px rgba(0,0,0,.06)}
  .icon{
    width:44px; height:44px; border-radius:12px; background:#f3f4f6; display:grid; place-items:center; font-size:22px;
  }
  .o-title{font-weight:700}
  .o-desc{font-size:13px; color:var(--ink-2)}
  .chev{margin-left:auto; font-size:18px; color:#c1c9d6}
  .hint{font-size:13px; color:var(--ink-2); text-align:center; margin-top:8px}

  .btn{
    width:100%; border:none; border-radius:14px; padding:14px 16px; font-size:16px; font-weight:800; cursor:pointer;
  }
  .btn-primary{background:var(--brand); color:#fff; box-shadow:0 10px 24px rgba(37,99,235,.25)}
  .btn-ghost{background:#f3f4f6; color:#111827}

  .footer{
    margin-top:16px; display:grid; gap:10px;
  }

  /* step control */
  [data-step]{display:none}
  [data-step].active{display:block; animation:fade .25s ease}
  @keyframes fade{from{opacity:0; transform:translateY(4px)} to{opacity:1; transform:none}}

  /* vibe chips */
  .chips{display:flex; flex-wrap:wrap; gap:10px; margin-top:10px}
  .chip{
    border:1px dashed #e5e7eb; padding:10px 12px; border-radius:999px; font-size:14px; cursor:pointer;
    user-select:none;
  }
  .chip.active{background:#fff7ed; border-color:#fed7aa; color:#9a3412}

  /* modal (quick setup) */
  .modal{
    position:fixed; inset:0; display:none; place-items:center; background:rgba(0,0,0,.32); z-index:50;
  }
  .modal.show{display:grid}
  .sheet{
    width:min(560px,92vw); background:#fff; border-radius:20px; padding:18px; box-shadow:var(--shadow)
  }
  .field{display:grid; gap:6px; margin:12px 0}
  input[type="text"], input[type="url"]{
    width:100%; padding:12px; border-radius:12px; border:1px solid #e5e7eb; font-size:15px;
  }

  /* confetti canvas */
  canvas#fx{position:fixed; inset:0; pointer-events:none}
</style>
</head>
<body>
<canvas id="fx"></canvas>

<div class="wrap">
  <header>
    <strong class="title">ä»Šå¤©ï¼Œè®“å¦³é¸ ğŸ—ºï¸</strong>
    <button class="gear" aria-label="è¨­å®š" title="è¨­å®š" id="openSetup">âš™ï¸</button>
  </header>

  <main>
    <section class="card">

      <!-- STEP 1: å•Ÿå‹• -->
      <div data-step="1" class="active">
        <span class="pill">å°å°å„€å¼æ„Ÿ</span>
        <div class="lead">ä»Šæ™šé¸æ“‡æ¬Šäº¤çµ¦å¦³</div>
        <div class="sub">æˆ‘æº–å‚™äº†å…©å€‹å£è¢‹ç›®çš„åœ°ã€‚<br>ä¸æ€¥ï¼Œè·Ÿè‘—æ„Ÿè¦ºèµ°å°±å¥½ã€‚</div>
        <div class="footer">
          <button class="btn btn-primary" id="start">é–‹å§‹æŒ‘é¸</button>
          <button class="btn btn-ghost" id="peek">å…ˆçœ‹çœ‹æœ‰å“ªäº›</button>
        </div>
      </div>

      <!-- STEP 2: é¸ç›®çš„åœ°ï¼ˆå…©å¼µå¡ï¼‰ -->
      <div data-step="2">
        <span class="pill">Step 1</span>
        <div class="lead">æƒ³å…ˆå»å“ªä¸€å€‹ï¼Ÿ</div>
        <div class="sub">é»ä¸€ä¸‹å¡ç‰‡å³å¯é¸æ“‡ï¼Œä¹Ÿå¯ä»¥å·¦å³æ»‘å‹•æ›é‚Šã€‚</div>

        <div class="stage" id="choices">
          <div class="option" data-pick="A">
            <div class="icon">ğŸ“</div>
            <div>
              <div class="o-title" id="spotA_name">å®‰å¹³è€è¡—</div>
              <div class="o-desc"  id="spotA_desc">è€å±‹å°å··æ…¢æ…¢èµ°</div>
            </div>
            <div class="chev">âœ</div>
          </div>
          <div class="option" data-pick="B">
            <div class="icon">ğŸŒŠ</div>
            <div>
              <div class="o-title" id="spotB_name">å››è‰ç¶ è‰²éš§é“</div>
              <div class="o-desc"  id="spotB_desc">è¢«æ¨¹å½±åŒ…åœçš„æ°´ä¸Šå°æ—…è¡Œ</div>
            </div>
            <div class="chev">âœ</div>
          </div>
          <div class="hint">* é€™å…©å€‹éƒ½æ˜¯å¦³ä¹‹å‰èªªã€Œä¸€å®šè¦å»ã€çš„ ğŸ’™</div>
        </div>
      </div>

      <!-- STEP 3: æ°›åœåŠ é»ï¼ˆå¯è·³éï¼‰ -->
      <div data-step="3">
        <span class="pill">Step 2</span>
        <div class="lead">æƒ³è¦å“ªç¨®ä»Šå¤©çš„æ°›åœï¼Ÿ</div>
        <div class="sub">ä¸ä¸€å®šè¦å…¨æ»¿åˆ†ï¼Œé¸ä¸€å€‹ç•¶ä¸»ç·šå°±å¥½ã€‚</div>

        <div class="chips" id="vibes">
          <div class="chip" data-vibe="æ…¢æ…¢æ•£æ­¥">ğŸš¶â€â™€ï¸ æ…¢æ…¢æ•£æ­¥</div>
          <div class="chip" data-vibe="ç¾é£Ÿæ¢ç´¢">ğŸœ ç¾é£Ÿæ¢ç´¢</div>
          <div class="chip" data-vibe="æ‹ç…§æ‰“å¡">ğŸ“· æ‹ç…§æ‰“å¡</div>
          <div class="chip" data-vibe="ç™‚ç™’æ”¾ç©º">ğŸŒ™ ç™‚ç™’æ”¾ç©º</div>
        </div>

        <div class="footer">
          <button class="btn btn-primary" id="finish">å®Œæˆé¸æ“‡</button>
          <button class="btn btn-ghost" id="skipVibe">å…ˆè·³é</button>
        </div>
      </div>

      <!-- STEP 4: çµæœ -->
      <div data-step="4">
        <span class="pill">å°±æ±ºå®šæ˜¯å¦³ ğŸ’«</span>
        <div class="lead" id="resultTitle">ä»Šæ™šä¸€èµ·å» â€”â€”</div>
        <div class="sub" id="resultSub">æˆ‘æœƒè² è²¬å°èˆªèˆ‡è·¯ä¸Šé©šå–œï¼Œå¦³åªè¦ç‰½è‘—æˆ‘å°±å¥½ã€‚</div>

        <div class="stage">
          <div class="option" style="cursor:default">
            <div class="icon" id="resultIcon">ğŸ“</div>
            <div>
              <div class="o-title" id="resultName">å®‰å¹³è€è¡—</div>
              <div class="o-desc"  id="resultVibe">æ°›åœï¼šæ…¢æ…¢æ•£æ­¥</div>
            </div>
          </div>
        </div>

        <div class="footer">
          <a id="mapLink" class="btn btn-primary" target="_blank" rel="noopener">æ‰“é–‹åœ°åœ–</a>
          <button class="btn btn-ghost" id="reshuffle">æƒ³é‡é¸ä¸€ä¸‹</button>
        </div>
      </div>

    </section>
  </main>
</div>

<!-- è¨­å®šé¢æ¿ï¼ˆå¯å³æ™‚æ”¹å…©å€‹ç›®çš„åœ°ï¼‰ -->
<div class="modal" id="setupModal" aria-hidden="true">
  <div class="sheet">
    <div class="lead" style="font-size:18px">å¿«é€Ÿè¨­å®šï¼ˆå¯éš¨æ™‚æ”¹ï¼‰</div>
    <div class="sub">å¡«å…¥å¥¹æä¾›çš„å…©å€‹å¿…å»é»ï¼›åœ°åœ–é€£çµå¯ç”¨ Google Maps å…±äº«é€£çµæˆ–åœ°åé—œéµå­—ã€‚</div>

    <div class="field">
      <label>ç›®çš„åœ° A åç¨±</label>
      <input type="text" id="inA_name" placeholder="å®‰å¹³è€è¡—" />
    </div>
    <div class="field">
      <label>ç›®çš„åœ° A ç°¡è¿°</label>
      <input type="text" id="inA_desc" placeholder="è€å±‹å°å··æ…¢æ…¢èµ°" />
    </div>
    <div class="field">
      <label>ç›®çš„åœ° A åœ°åœ–ï¼ˆå¯æ”¾ç¶²å€æˆ–åœ°åï¼‰</label>
      <input type="text" id="inA_map" placeholder="å®‰å¹³è€è¡—" />
    </div>

    <div class="field">
      <label>ç›®çš„åœ° B åç¨±</label>
      <input type="text" id="inB_name" placeholder="å››è‰ç¶ è‰²éš§é“" />
    </div>
    <div class="field">
      <label>ç›®çš„åœ° B ç°¡è¿°</label>
      <input type="text" id="inB_desc" placeholder="è¢«æ¨¹å½±åŒ…åœçš„æ°´ä¸Šå°æ—…è¡Œ" />
    </div>
    <div class="field">
      <label>ç›®çš„åœ° B åœ°åœ–ï¼ˆå¯æ”¾ç¶²å€æˆ–åœ°åï¼‰</label>
      <input type="text" id="inB_map" placeholder="å››è‰ç¶ è‰²éš§é“" />
    </div>

    <div style="display:flex; gap:10px; margin-top:8px">
      <button class="btn btn-ghost" id="closeSetup">å–æ¶ˆ</button>
      <button class="btn btn-primary" id="saveSetup">å„²å­˜</button>
    </div>
  </div>
</div>

<script>
  // --- ç°¡å–®ç‹€æ…‹ ---
  const S = {
    A: { name:"å®‰å¹³è€è¡—", desc:"è€å±‹å°å··æ…¢æ…¢èµ°", map:"å®‰å¹³è€è¡—", icon:"ğŸ“" },
    B: { name:"å››è‰ç¶ è‰²éš§é“", desc:"è¢«æ¨¹å½±åŒ…åœçš„æ°´ä¸Šå°æ—…è¡Œ", map:"å››è‰ç¶ è‰²éš§é“", icon:"ğŸŒŠ" },
    pick:null, vibe:null
  };

  // --- å·¥å…· ---
  const $ = s=>document.querySelector(s);
  const $$ = s=>document.querySelectorAll(s);
  const setStep = n=>{
    $$('[data-step]').forEach(el=>el.classList.remove('active'));
    $(`[data-step="${n}"]`).classList.add('active');
    window.scrollTo({top:0,behavior:'smooth'});
  };
  const vibrate = ms=>{ if (window.navigator.vibrate) navigator.vibrate(ms) };

  // åˆå§‹åŒ–é¡¯ç¤º
  const syncUI=()=>{
    $('#spotA_name').textContent = S.A.name;
    $('#spotA_desc').textContent = S.A.desc;
    $('#spotB_name').textContent = S.B.name;
    $('#spotB_desc').textContent = S.B.desc;
  };
  syncUI();

  // Step1
  $('#start').addEventListener('click', ()=>{ vibrate(10); setStep(2); });
  $('#peek').addEventListener('click', ()=>{ vibrate(5); document.getElementById('openSetup').click(); });

  // Step2 é¸æ“‡
  $$('#choices .option').forEach(op=>{
    op.addEventListener('click', ()=>{
      const which = op.dataset.pick;
      S.pick = which;
      vibrate([15,30,15]);
      setStep(3);
    });
    // ç°¡å–®æ»‘å‹•æ›é‚Šï¼ˆéå¿…è¦ï¼‰
    let sx=null;
    op.addEventListener('touchstart', e=>{ sx=e.touches[0].clientX; }, {passive:true});
    op.addEventListener('touchmove', e=>{
      if(sx===null) return;
      const dx = e.touches[0].clientX - sx;
      op.style.transform=`translateX(${dx/8}px) rotate(${dx/80}deg)`;
      op.style.borderColor = Math.abs(dx)>40 ? '#c7d2fe' : '#eef2f7';
    }, {passive:true});
    op.addEventListener('touchend', e=>{
      op.style.transform=''; op.style.borderColor='#eef2f7'; sx=null;
    });
  });

  // Step3 æ°›åœ
  $$('#vibes .chip').forEach(ch=>{
    ch.addEventListener('click', ()=>{
      $$('#vibes .chip').forEach(x=>x.classList.remove('active'));
      ch.classList.add('active');
      S.vibe = ch.dataset.vibe;
      vibrate(8);
    });
  });
  $('#finish').addEventListener('click', ()=>{
    renderResult(); fireConfetti(); setStep(4);
  });
  $('#skipVibe').addEventListener('click', ()=>{
    S.vibe = null; renderResult(); fireConfetti(); setStep(4);
  });

  // Step4 çµæœ
  function renderResult(){
    const chosen = S[ S.pick || 'A' ];
    $('#resultIcon').textContent = chosen.icon || 'ğŸ“';
    $('#resultName').textContent = chosen.name;
    $('#resultTitle').textContent = `ä»Šæ™šä¸€èµ·å» â€”â€” ${chosen.name}`;
    $('#resultVibe').textContent = S.vibe ? `æ°›åœï¼š${S.vibe}` : 'æ°›åœï¼šéš¨å¿ƒæ‰€æ¬²';
    // åœ°åœ–é€£çµï¼šè‹¥å¡«çš„æ˜¯ç¶²å€å°±ç›´æ¥ç”¨ï¼›è‹¥æ˜¯åœ°åå‰‡å¸¶åˆ° Google Maps æœå°‹
    const url = (chosen.map||'').trim();
    const finalURL = /^https?:\/\//i.test(url)
      ? url
      : `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(url||chosen.name)}`;
    const link = $('#mapLink');
    link.href = finalURL;
    link.textContent = `æ‰“é–‹ ${chosen.name} çš„åœ°åœ–`;
  }
  $('#reshuffle').addEventListener('click', ()=>{ setStep(2); });

  // è¨­å®šé¢æ¿
  const setup = {
    open: ()=>$('#setupModal').classList.add('show'),
    close: ()=>$('#setupModal').classList.remove('show'),
    load: ()=>{
      $('#inA_name').value=S.A.name;  $('#inA_desc').value=S.A.desc;  $('#inA_map').value=S.A.map;
      $('#inB_name').value=S.B.name;  $('#inB_desc').value=S.B.desc;  $('#inB_map').value=S.B.map;
    },
    save: ()=>{
      S.A.name=$('#inA_name').value||S.A.name;
      S.A.desc=$('#inA_desc').value||S.A.desc;
      S.A.map =$('#inA_map').value||S.A.map;
      S.B.name=$('#inB_name').value||S.B.name;
      S.B.desc=$('#inB_desc').value||S.B.desc;
      S.B.map =$('#inB_map').value||S.B.map;
      syncUI();
    }
  };
  $('#openSetup').addEventListener('click', ()=>{ setup.load(); setup.open(); });
  $('#closeSetup').addEventListener('click', setup.close);
  $('#saveSetup').addEventListener('click', ()=>{ setup.save(); setup.close(); });

  // å°å½©å¸¶ï¼ˆæ¥µè¼•é‡ï¼‰
  const cvs = document.getElementById('fx');
  const ctx = cvs.getContext('2d');
  let W=0,H=0; function fit(){ W= cvs.width = window.innerWidth; H= cvs.height = window.innerHeight; } fit();
  window.addEventListener('resize', fit);
  function fireConfetti(){
    const N=80, P=[];
    for(let i=0;i<N;i++){
      P.push({
        x:Math.random()*W, y:-20, r:2+Math.random()*4, vy:1+Math.random()*3, vx:(Math.random()-.5)*1.2, a:1
      });
    }
    let t=0; const tick=()=>{
      ctx.clearRect(0,0,W,H);
      P.forEach(p=>{
        p.x+=p.vx; p.y+=p.vy; p.a*=0.994;
        ctx.globalAlpha=p.a;
        ctx.beginPath(); ctx.arc(p.x,p.y,p.r,0,Math.PI*2); ctx.fillStyle=`hsl(${(t+p.x)%360} 90% 60%)`; ctx.fill();
      });
      ctx.globalAlpha=1;
      t+=2;
      if (P.some(p=>p.a>0.02 && p.y<H+12)) requestAnimationFrame(tick);
      else ctx.clearRect(0,0,W,H);
    };
    tick();
  }

  // è‹¥è£ç½®æ”¯æ´ PWA/å…¨è¢å¹•ï¼Œå¯å†è£œå…¥å£ï¼ˆç­‰ä½ çµ¦é¢¨æ ¼æˆ‘å†åŠ ï¼‰
</script>
</body>
</html>
